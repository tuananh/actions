name: Action Test

on:
  push:
    branches:
      - "main"

jobs:

  gen-key:
    name: gen-key test
    runs-on: ubuntu-latest

    steps:
      - id: gen_key
        uses: tuananh/actions/gen-key@main
        with:
          email: ci@tuananh.org
      - name: print pub key
        run: |
          echo ${{ steps.gen_key.outputs.pub-key }}
  
  setup-crane:
    name: setup-crane test
    runs-on: ubuntu-latest

    steps:
      - uses: tuananh/actions/setup-crane@main
        with:
          ref: main
      - name: test crane
        run: |
          crane version
  
  kaniko-build:
    name: kaniko-build test
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
      - uses: tuananh/actions/kaniko-build@main
        with:
          dockerfile: ./kaniko-build/Dockerfile
          no-push: true